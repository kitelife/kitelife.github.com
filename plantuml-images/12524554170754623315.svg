<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="359px" preserveAspectRatio="none" style="width:373px;height:359px;background:#FFFFFF;" version="1.1" viewBox="0 0 373 359" width="373px" zoomAndPan="magnify"><defs><filter height="300%" id="f1qmkikx8h1k1w" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[f6e985c52c69bd53b6c4d60dc6cbe75a]
class DBImpl::Writer--><rect codeLine="4" fill="#FEFECE" filter="url(#f1qmkikx8h1k1w)" height="120" id="DBImpl::Writer" style="stroke:#A80036;stroke-width:1.5;" width="153" x="82" y="7"/><ellipse cx="106.45" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M108.8675,28.1851 Q108.3548,28.4487 107.7908,28.5806 Q107.2269,28.7124 106.6043,28.7124 Q104.3924,28.7124 103.2278,27.2549 Q102.0633,25.7974 102.0633,23.0435 Q102.0633,20.2822 103.2278,18.8247 Q104.3924,17.3672 106.6043,17.3672 Q107.2269,17.3672 107.7981,17.499 Q108.3694,17.6309 108.8675,17.8945 L108.8675,20.2969 Q108.3108,19.7842 107.7872,19.5461 Q107.2635,19.3081 106.7068,19.3081 Q105.5203,19.3081 104.9161,20.2493 Q104.3118,21.1904 104.3118,23.0435 Q104.3118,24.8892 104.9161,25.8303 Q105.5203,26.7715 106.7068,26.7715 Q107.2635,26.7715 107.7872,26.5334 Q108.3108,26.2954 108.8675,25.7827 Z " fill="#000000"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="100" x="122.55" y="28.25">DBImpl::Writer</text><line style="stroke:#A80036;stroke-width:1.5;" x1="83" x2="234" y1="39" y2="39"/><ellipse cx="93" cy="50" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="127" x="102" y="57.25">WriteBatch* batch</text><ellipse cx="93" cy="68" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="65" x="102" y="75.25">bool sync</text><ellipse cx="93" cy="86" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="68" x="102" y="93.25">bool done</text><ellipse cx="93" cy="104" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="116" x="102" y="111.25">port::CondVar cv</text><line style="stroke:#A80036;stroke-width:1.5;" x1="83" x2="234" y1="119" y2="119"/><!--MD5=[7a25074348cef7ab2883f0ca1a94cf57]
class WriteBatch--><rect codeLine="11" fill="#FEFECE" filter="url(#f1qmkikx8h1k1w)" height="48" id="WriteBatch" style="stroke:#A80036;stroke-width:1.5;" width="109" x="7" y="252"/><ellipse cx="22" cy="268" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M24.4175,273.1851 Q23.9048,273.4487 23.3408,273.5806 Q22.7769,273.7124 22.1543,273.7124 Q19.9424,273.7124 18.7778,272.2549 Q17.6133,270.7974 17.6133,268.0435 Q17.6133,265.2822 18.7778,263.8247 Q19.9424,262.3672 22.1543,262.3672 Q22.7769,262.3672 23.3481,262.499 Q23.9194,262.6309 24.4175,262.8945 L24.4175,265.2969 Q23.8608,264.7842 23.3372,264.5461 Q22.8135,264.3081 22.2568,264.3081 Q21.0703,264.3081 20.4661,265.2493 Q19.8618,266.1904 19.8618,268.0435 Q19.8618,269.8892 20.4661,270.8303 Q21.0703,271.7715 22.2568,271.7715 Q22.8135,271.7715 23.3372,271.5334 Q23.8608,271.2954 24.4175,270.7827 Z " fill="#000000"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="77" x="36" y="273.25">WriteBatch</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="115" y1="284" y2="284"/><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="115" y1="292" y2="292"/><!--MD5=[9babc3924dac11f1afd7e2871a180584]
class port::CondVar--><rect codeLine="12" fill="#FEFECE" filter="url(#f1qmkikx8h1k1w)" height="138" id="port::CondVar" style="stroke:#A80036;stroke-width:1.5;" width="208" x="151.5" y="207"/><ellipse cx="203.25" cy="223" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M205.6675,228.1851 Q205.1548,228.4487 204.5908,228.5806 Q204.0269,228.7124 203.4043,228.7124 Q201.1924,228.7124 200.0278,227.2549 Q198.8633,225.7974 198.8633,223.0435 Q198.8633,220.2822 200.0278,218.8247 Q201.1924,217.3672 203.4043,217.3672 Q204.0269,217.3672 204.5981,217.499 Q205.1694,217.6309 205.6675,217.8945 L205.6675,220.2969 Q205.1108,219.7842 204.5872,219.5461 Q204.0635,219.3081 203.5068,219.3081 Q202.3203,219.3081 201.7161,220.2493 Q201.1118,221.1904 201.1118,223.0435 Q201.1118,224.8892 201.7161,225.8303 Q202.3203,226.7715 203.5068,226.7715 Q204.0635,226.7715 204.5872,226.5334 Q205.1108,226.2954 205.6675,225.7827 Z " fill="#000000"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="96" x="223.75" y="228.25">port::CondVar</text><line style="stroke:#A80036;stroke-width:1.5;" x1="152.5" x2="358.5" y1="239" y2="239"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="159.5" y="247"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="182" x="171.5" y="257.25">std::condition_variable cv_</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="159.5" y="265"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="122" x="171.5" y="275.25">Mutex* const mu_</text><line style="stroke:#A80036;stroke-width:1.5;" x1="152.5" x2="358.5" y1="283" y2="283"/><ellipse cx="162.5" cy="294" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="78" x="171.5" y="301.25">void Wait()</text><ellipse cx="162.5" cy="312" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="87" x="171.5" y="319.25">void Signal()</text><ellipse cx="162.5" cy="330" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="103" x="171.5" y="337.25">void SignalAll()</text><!--MD5=[2fcbacfebf89e497b5752e128b08e4b8]
link DBImpl::Writer to WriteBatch--><path codeLine="20" d="M130.7,127.32 C111.33,168.65 86.54,221.57 72.5,251.53 " fill="none" id="DBImpl::Writer-WriteBatch" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="30" x="116.81" y="172.25">关联</text><!--MD5=[4fd470c37664649366fe02e7821d418b]
link DBImpl::Writer to port::CondVar--><path codeLine="21" d="M186.3,127.32 C197.88,152.05 211.41,180.92 223.42,206.54 " fill="none" id="DBImpl::Writer-port::CondVar" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><text fill="#000000" font-family="Albert Sans" font-size="15" lengthAdjust="spacing" textLength="30" x="208" y="172.25">关联</text><!--MD5=[3bf5be27a810f9072f19c7ba9a696913]
@startuml
skinparam defaultFontName "Albert Sans"
skinparam defaultFontSize 15
scale max 800 width
class DBImpl::Writer {
+ WriteBatch* batch
+ bool sync
+ bool done
+ port::CondVar cv
}

class WriteBatch {}
class port::CondVar {
+ void Wait()
+ void Signal()
+ void SignalAll()

- std::condition_variable cv_
- Mutex* const mu_
}
DBImpl::Writer .. WriteBatch: 关联
DBImpl::Writer .. port::CondVar: 关联
@enduml

PlantUML version 1.2021.12(Wed Oct 06 00:01:58 CST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>